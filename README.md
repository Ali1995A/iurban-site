# iurban-site（中国人口预测分析工具）

这是一个单页静态网站（`index.html`），用于可视化中国人口历史数据，并基于可调参数对未来人口、出生、死亡趋势做情景预测。

## 功能概览

- 两种视图：
  - **总人口趋势**：历史人口 + 预测区间与基准线
  - **出生 vs 死亡**：历史出生/死亡 + 预测曲线与区间
- 预测参数可调：出生衰减率（保守/中性/乐观）、死亡率模型（老龄化/平衡/医疗进步）等
- 支持：导出数据（JSON）、导出图表（PNG）、事件标记开关、蒙特卡洛模拟（基于当前参数扰动）

## 快速开始

本项目无需构建与依赖安装，直接打开即可运行。

### 方式 1：直接打开

用浏览器打开 `iurban-site/index.html`。

> 说明：如果浏览器限制本地文件访问或字体/脚本加载异常，建议使用本地静态服务器方式打开。

### 方式 2：本地静态服务器（推荐）

在仓库目录下运行（任选其一）：

- PowerShell + Python：
  - `cd d:\Soft\MyCode\iurban-site`
  - `python -m http.server 5173`
  - 浏览器访问 `http://127.0.0.1:5173/`

## 数据口径与单位

历史数据写在 `iurban-site/index.html` 的 `historyMap` 中，结构为：

```js
const historyMap = {
  '年份': [年末总人口(万人), 出生人口(万人), 死亡人口(万人)],
  // ...
};
```

- `年末总人口`：单位 **万人**
  - 例如：`140489` 表示 `140489 万人 = 14.0489 亿人`
- `出生人口` / `死亡人口`：单位也为 **万人**
  - 例如：`792` 表示 `792 万人`

页面中的图表与统计卡片均基于该数据源自动生成。

## 2025 年人口数据更新（已完成）

根据你提供的国家统计局 2025 年数据：

- 出生人口：`792` 万人
- 死亡人口：`1131` 万人

已将 2025 年数据加入 `historyMap`，并让图表/统计自动以最新历史年份作为预测起点（不再在代码里硬编码 `2024`），从而保持预测终点仍为 **2045**，同时让“历史数据”部分自动扩展到 **2025**。

对应新增的数据行如下（单位：万人）：

```js
'2025':[140489,792,1131]
```

其中 `140489` 为根据 `2024 年末总人口 + (出生 - 死亡)` 推算得到的年末总人口（万人）：

- `2024 年末总人口：140828`
- `自然变动：792 - 1131 = -339`
- `2025 年末总人口：140828 - 339 = 140489`

如果你后续拿到国家统计局公布的 **2025 年末总人口** 的权威值（可能包含口径调整等），只需要把 `140489` 替换为官方值即可，图表会自动更新。

## 以后如何更新到新年份（例如 2026）

1. 打开 `iurban-site/index.html`
2. 找到 `const historyMap = {...}`（搜索 `historyMap`）
3. 按相同结构追加新年份：
   - `'2026':[年末总人口(万人), 出生人口(万人), 死亡人口(万人)]`
4. 保存后刷新页面即可

> 页面会自动以 `historyMap` 的最后一年作为“最新历史年”，并自动将预测延伸到 2045；通常不需要再改其它代码。

## 常见问题

### 1）图表不显示？

- 请确认网络可访问 `https://cdn.jsdelivr.net/`（本页面通过 CDN 加载 ECharts）
- 或使用本地静态服务器打开，避免浏览器对 `file://` 的限制

### 2）导出的数据单位是什么？

导出的 JSON 与页面内部一致：

- 人口/出生/死亡：均为 **万人**

## 文件结构

- `iurban-site/index.html`：完整页面与全部逻辑（数据、图表、交互、预测模型）
- `iurban-site/README.md`：说明文档（本文件）

